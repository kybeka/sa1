<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">

    <meta name="author" content="Philip Krause">

    <meta name="keywords" content="wannacry Backdoor, government, korea, hacking,ransomware">

    <title>Group 1 progect | homepage</title>
    <link rel="stylesheet" href="../../general/index.css">
    <link rel="stylesheet" href="../css/article.css">
  </head>
  <body>
    <script type="text/javascript" src="../../general/index.js"></script>

    <nav>
      <ul id="main_nav_bar">
        <!-- main navigation bar; these methods are used to move resize and move
      the main content, without overlapping it with the sidebar -->
        <li id='nav_img' class="icon-bg"
        onmouseover="setStyle('main', 'width','calc(100% - 150px)');
                      setStyle('main','left','150px');"
        onmouseout="setStyle('main','width','calc(98% - 51px)');
                    setStyle('main','left','50px')"
        ondblclick="window.location = '../../index.html'">
        <div id="sidebar">
          <ul id="sidebar-cont">
            <li> <a href='#1'>1</a></li>
            <li> <a href='#2'>2</a></li>
            <li> <a href='#3'>3</a></li>
          </ul>
          </div>
        </li>
        <!-- main header and navigation bar links of the rest of the page -->
      <li id="main_header">
        <a href="">
          <header>
            <b>About</b>
          </header>
        </a>
      </li>
      <li> <a href= "../../history/history.html">History</a> <br>
      </li>
      <li> <a href = "../../compvir/compvir.html">Computer Viruses</a> <br>
        <ul class="dropdown">
          <li><a href="../../compvir/compvir.html">Virus</a>
            <ul class="dropdown2">
              <li> <a href="../../compvir/html/BackDoor.html"> Backdoor</a></li>
              <li> <a href="../../compvir/html/bug.html"> Bugs</a></li>
              <li> <a href="../../compvir/html/bug2.html"> Bugs II</a></li>
              <li> <a href="../../compvir/html/CompanionVirus.html"> Companion Virus</a></li>
              <li> <a href="../../compvir/html/ComputerWorm.html"> Computer Worm</a></li>
              <li> <a href="../../compvir/html/Directory Virus.html"> Directory Virus</a></li>
              <li> <a href="../../compvir/html/MULTIPARTITE-VIRUS.html"> Multipartite Virus</a></li>
              <li> <a href="../../compvir/html/MULTIPARTITE-VIRUS-2.html"> Multipartite Virus II</a></li>
              <li> <a href="../../compvir/html/polymorphicvirus.html"> Polymorphic Virus</a></li>
              <li> <a href="../../compvir/html/polyvirus2.html"> Polymorphic Virus II</a></li>
              <li> <a href="../../compvir/html/residentvirus.html"> Resident Virus</a></li>
              <li> <a href="../../compvir/html/Social Engineering and Phishing.html"> Social Engineering <br> & Phishing</a></li>
              <li> <a href="../../malware/html/TROJANS.html"> Trojans</a></li>
              <li> <a href="../../malware/html/TROJAN2.html"> Trojans II</a></li>
              <li> <a href="../../malware/html/TROJAN3.html"> Trojans III</a></li>
              <li> <a href="../../malware/html/TROJAN4.html"> Trojans IV</a></li>
              <li> <a href="../../compvir/html/Web Scripting Virus.html"> WebScripting Virus</a></li>
              <li> <a href="../../malware/html/Macrovirus.html"> MacroVirus</a></li>
              <li> <a href="../../malware/html/overwritingvirus.html"> Overwrite virus</a></li>
              <li> <a href="../../malware/html/Bootsector_viruses.html"> Bootsector Viruses</a></li>
              <li> <a href="../../compvir/html/CarbanakAPT.html"> CarbanakAPT</a></li>
              <li> <a href="../../compvir/html/WannaCryy-1.html"> WannaCry I</a></li>
              <li> <a href="../../compvir/html/WannaCry-2.html"> WannaCry II</a></li>
              <li> <a href="../../compvir/html/Zeus.html"> Zeus</a></li>
            </ul>
          </li>
          <li><a href="../../malware/malware.html"> Malware</a>
            <ul class="dropdown2">
              <li> <a href="../../malware/html/Adware_Rerevisioned.html"> Adware Revisioned</a></li>
              <li> <a href="../../malware/html/botnet.html"> Botnet</a></li>
              <li> <a href="../../malware/html/botnet2.html"> Botnet II</a></li>
              <li> <a href="../../malware/html/cryptojacking.html"> Cryptojacking</a></li>
              <li> <a href="../../malware/html/cyberwarfare.html"> Cyberwarfare</a></li>
              <li> <a href="../../malware/html/Data_Breach.html"> Data Breach</a></li>
              <li> <a href="../../malware/html/Fileless_malware.html"> Fileless Malware</a></li>
              <li> <a href="../../malware/html/Fileless_malware2.html"> Fileless Malware II</a></li>
              <li> <a href="../../malware/html/Greyware.html"> Greyware</a></li>
              <li> <a href="../../malware/html/keylogger.html"> Keylogger</a></li>
              <li> <a href="../../compvir/html/ScareWare.html"> ScareWare</a></li>
              <li> <a href="../../malware/html/maliciousapps.html"> Malicious Apps</a></li>
              <li> <a href="../../malware/html/maliciousapps2.html"> Malicious Apps II</a></li>
              <li> <a href="../../malware/html/Malware_Rerevisioned.html"> Malware re-revisioned</a></li>
              <li> <a href="../../compvir/html/videogamesMalware.html"> Malware in videogames</a></li>
              <li> <a href="../../malware/html/RAMscrapper.html"> RamScraper</a></li>
              <li> <a href="../../malware/html/ransomware.html"> Ransomware</a></li>
              <li> <a href="../../compvir/html/EffectRansomware.html"> EffectRansomWare</a></li>
              <li> <a href="../../malware/html/rootkits.html"> Rootkit</a></li>
              <li> <a href="../../malware/html/Spam.html"> Spam</a></li>
              <li> <a href="../../malware/html/Spyware_Rerevisioned.html"> Spyware Revisioned</a></li>
              <li> <a href="../../malware/html/Trickbot.html"> Trickbot</a></li>
              <li> <a href="../../compvir/html/appliance-based malware.html"> Appliance-Based Malware</a></li>
              <li> <a href="../../malware/html/DDoS.html"> DDOS</a></li>
              <li> <a href="../../malware/html/Emotet.html"> Emotet</a></li>
              <li> <a href="../../malware/html/cyberwarfare.html"> Cryptocurrency scam</a></li>
              <li> <a href="../../malware/html/twitchhack.html"> Twitch Hack</a></li>
              <li> <a href="../../malware/html/malware_in_cars.html"> Malware in cars</a></li>
              <li> <a href="../../malware/html/yahoohack.html"> Yahoo Hack</a></li>
            </ul>
          </li>
        </ul>
      </li>
      <li> <a href = "../../security/security.html"> Security </a> </li>
      <li id="Search" class="icon-bg">
        <input type="search" id=searchBar class="icon-bg"
        incremental="incremental" onsearch="search()">
        <ul id="search_results"></ul>
      </li>
      <li id="sidetoggle" class="icon-bg">
        <label for="chmode" id="chmode-cont">
          <input type="checkbox" id="chmode" name="chmode"
          value="dark" onclick="toggleRoot('chmode','--main-col', '--dark-main-cl', '--light-main-cl');
                              toggleRoot('chmode','--second-col', '--dark-second-cl', '--light-second-cl')">
          <span id="mark" class="icon-bg"></span>
        </label>
      </li>
    </ul>
    </nav>
<!-- TODO: if we change the tag to a div, we could avoid problems with footer in the main tag and similar -->
    <main id="main">

       <table>
         <th class="imghead">
           <h2 class="title">WannaCry Analysis</h2>

           </th>


         </table>
         <hr><hr>

         <!-- second part of the page-->

         <table>
           <th class="imghead2">
             <h3 class="subtitle">Modular Structure</h3>
             <br>

             <p class="text2">
              The WannaCry randsomware can be broken down into three modular pieces,
              each utilizing a different exploit/vulnerability.

              <b>1. The Worm </b> <br><br><br>

              Upon infecting a host, WannaCry starts to scan the local network
              and random IP addresses on the internet. It does so to find ones
              using the Microsoft SMB protocol. This protcol is used by Windows to
              share documents between computers. It is at this point that
              it employs the EternalBlue exploit. EternalBlue had existed for several
              years before the advent of WannaCry, and it was only WannaCry
              that forced the NSA to inform Microsoft of the vulnerability. It
              works by exploiting the way some versions of Windows mishandle certain
              packets to allow an attacker to execute code on the target. This element
              allows it to copy and execute itself on remote computers.

              <b>2. The Kill Switch </b> <br><br><br>

              Once WannaCry finds a target it drops the file mssecsvc.exe which then executes
              tasksche.exe, the Kill-switch checker. If the server does not
              exist then it proceeds to install the DOUBLEPULSAR backdoor. This allows
              it to gain persistence after which it installs the payload.


              <b>3. The Payload </b> <br><br><br>

              After the intial check, tasksche.exe continues by searching the hosts
              files for directories starting with single letters such as C:/ and etc.
              It proceeds to encrypt them using 2048-bit RSA and make a new directory.
              Inside this newly created directory it adds several helper .exe files including
              tor.exe. After running it tor.exe, the malware connects through a tor node
              to hide the operators of WannaCry. Upon encrypting all the files,
              it produces the red randsome note senn on the previous page. This note
              instructs the victim to transfer $300 of BTC to a BTC wallet.









               </p></th>


             </table>
             <hr>

             <table>
               <th class="imghead2">
                 <h3 class="subtitle">Kill Switch Mechanism</h3>
                 <br>


                 <p class="text2"> The origin of this kill-switch mechanism
                was intiailly disputed. However it it is agreed upon that
                the kill-switch was intentionally placed in the code by the makers.
                Two theories exist for its existence even after variants sprung up
                in response to the original version being stopped because of this kill switch.
                The first is that the operators of WannaCry wanted to have the ability
                to stop the attack for whatever reason. This seems unlikely. The stronger
                theory supports that it was employed as a way to prevent analysis in a sandbox.
                The idea is that if it were captured for analysis in an airgapped setting
                it would not be able to check whether the kill switch domain is live. This
                means it does not execute, making its analysis significantly harder.










              </p></th>

                 </table>
                 <hr>

                 <table>
                   <th class="imghead2">
                     <h3 class="subtitle">Operatives</h3>
                     <br>


                     <p class="text2">
                       While the creators are still unknown, many clues have been
                       found within the various variants. The current suspect behind
                       WannaCry is the Lazarus Group. It is a known criminal hacking
                       operation with links to the North Korean government. Among the clues
                       included were that the computer that created the ransom notes
                       has a special Korean language font installed. The time on infected
                       computers was automatically set to UTC +09:00 the time zone of Korea. In additon,
                       it is presumed that the Chinese language randsom note was the original,
                       and the English one being a machine-translation. Despite many fingers
                       pointed at North Korean state actors and the United States officially
                       placing blame on them, very little new evidence has come to light. Ultimately it is
                       clear that WannaCry was developed purely for economic gain, with no clear alterior motive.



                     </p>
                   </th>

                 </table>



                 <table>
                   <th class="imghead2">
                     <h3 class="subtitle">The Original Bitcoin Wallets</h3>
                     <br>


                     <p class="text2">

                       Hard coded into WannaCry are three Bitcoin addresses to which
                       victims could pay the randsom. These are: <br><br><br>

                       - 13AM4VW2dhxYgXeQepoHkHSQuy6NgaEb94 <br><br><br>
                       - 115p7UMMngoj1pMvkpHijcRdfJNXj6LrLn <br><br><br>
                       - 12t9YDPgwueZ9NyMgw519p7AA8isjr6SMw <br><br><br>

                          Looking at these 3 wallets we discover two interesting pieces of information.
                          Firstly, the operators did not earn very much money for the amount of computers infected. In fact
                          at the time of the attack they netted around $150,000. While they did not
                          move the coins for some time, it seems that over 2 years most of these wallets were drained
                          over many small transactions. Due to the
                          fact that these wallets are known to be associated to the attack, it remains quite difficult
                          for the operatives to exchange their Bitcoin for fiat currency. This may have played in their favor
                          as the combined value of those wallets today is over 3 million USD. <br><br><br>
                          The second piece of information that can be gleaned from this is that WannaCry is still in operation.
                          The wallets continue to see input transactions long after the operatives have cashed out. This means that
                          people are still paying the ransom in hopes of recieving their files back, despite no reports of anyone
                          ever getting them back after paying it. These newer transactions likely explain why the wallets still hold roughly 60,000 USD.



                       <br><br>



                       <img src="../images/WannaCry_Images/wallet_1.png" alt="BTC Wallet 1 Balance" >
                       <img src="../images/WannaCry_Images/Wallet2.png" alt="BTC Wallet 1 Balance" >
                       <img src="../images/WannaCry_Images/wallet3.png" alt="BTC Wallet 1 Balance" >

                            <br> <br>







                     </p>
                   </th>

                 </table>


       <hr>
       <table width="100%;" class="footer">
         <th class="space" width="33%"><h1 class="chapter">WannaCry</h1></th>
         <th class="name" width="33%"> <h1>Philip Krause</h1></th>
         <th width="33%"> <a href="Zeus.html" class="arrow" title="next article">
           <img src="../../general/icons/arrow.svg" height="45" width="125" alt="next article" class="icon-img"></a>
         </th>
       </table>
    </main>
  </body>
</html>
